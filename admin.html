<!DOCTYPE html>
<html>
<head>
  <title>Messages</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const firebaseConfig = {
        apiKey: "AIzaSyBty7-Ncgs2ABlIxXWybqhavT5FgnK9CBg",
        authDomain: "p-web-db.firebaseapp.com",
        projectId: "p-web-db",
        storageBucket: "p-web-db.firebasestorage.app",
        messagingSenderId: "762422687989",
        appId: "1:762422687989:web:7b21e0e7a467f634cb6dbc",
        measurementId: "G-4GSGV6NDC6"
      };

      if (!firebase.apps.length) {
        firebase.initializeApp(firebaseConfig);
      }

      const messagesContainer = document.getElementById('messages');

      firebase.database().ref('contacts').on('value', (snapshot) => {
        const messages = snapshot.val();

        if (!messages) {
          messagesContainer.textContent = 'No messages yet.';
          return;
        }

        const items = Object.entries(messages)
          .sort(([, a], [, b]) => new Date(b.timestamp) - new Date(a.timestamp))
          .map(([, value]) => `â€¢ ${value.name} <${value.email}>\n  ${value.message}\n  Sent: ${new Date(value.timestamp).toLocaleString()}`)
          .join('\n\n');

        messagesContainer.textContent = items;
      });
    });
  </script>
</head>
<body>
  <pre id="messages">Loading...</pre>
</body>
</html>
